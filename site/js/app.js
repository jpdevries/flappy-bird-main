!function t(e,n,i){function s(o,a){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(r)return r(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[o]={exports:{}};e[o][0].call(h.exports,function(t){var n=e[o][1][t];return s(n?n:t)},h,h.exports,t,e,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(t,e,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,r,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],a(n))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(o(n))for(r=Array.prototype.slice.call(arguments,1),u=n.slice(),i=u.length,c=0;i>c;c++)u[c].apply(this,r);return!0},i.prototype.addListener=function(t,e){var n;if(!s(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,s(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!s(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},i.prototype.removeListener=function(t,e){var n,i,r,a;if(!s(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],r=n.length,i=-1,n===e||s(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=r;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],s(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?s(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(s(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],3:[function(t,e,n){function i(){h=!1,a.length?u=a.concat(u):p=-1,u.length&&s()}function s(){if(!h){var t=setTimeout(i);h=!0;for(var e=u.length;e;){for(a=u,u=[];++p<e;)a&&a[p].run();p=-1,e=u.length}a=null,h=!1,clearTimeout(t)}}function r(t,e){this.fun=t,this.array=e}function o(){}var a,c=e.exports={},u=[],h=!1,p=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new r(t,e)),1!==u.length||h||setTimeout(s,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=o,c.addListener=o,c.once=o,c.off=o,c.removeListener=o,c.removeAllListeners=o,c.emit=o,c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],4:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],5:[function(t,e,n){(function(e,i){function s(t,e){var i={seen:[],stylize:o};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),v(e)?i.showHidden=e:e&&n._extend(i,e),x(i.showHidden)&&(i.showHidden=!1),x(i.depth)&&(i.depth=2),x(i.colors)&&(i.colors=!1),x(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=r),c(i,t,i.depth)}function r(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function o(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function c(t,e,i){if(t.customInspect&&e&&O(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var s=e.inspect(i,t);return w(s)||(s=c(t,s,i)),s}var r=u(t,e);if(r)return r;var o=Object.keys(e),v=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),S(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(e);if(0===o.length){if(O(e)){var y=e.name?": "+e.name:"";return t.stylize("[Function"+y+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(E(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return h(e)}var g="",m=!1,b=["{","}"];if(d(e)&&(m=!0,b=["[","]"]),O(e)){var x=e.name?": "+e.name:"";g=" [Function"+x+"]"}if(_(e)&&(g=" "+RegExp.prototype.toString.call(e)),E(e)&&(g=" "+Date.prototype.toUTCString.call(e)),S(e)&&(g=" "+h(e)),0===o.length&&(!m||0==e.length))return b[0]+g+b[1];if(0>i)return _(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var I;return I=m?p(t,e,i,v,o):o.map(function(n){return l(t,e,i,v,n,m)}),t.seen.pop(),f(I,g,b)}function u(t,e){if(x(e))return t.stylize("undefined","undefined");if(w(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):v(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,i,s){for(var r=[],o=0,a=e.length;a>o;++o)z(e,String(o))?r.push(l(t,e,n,i,String(o),!0)):r.push("");return s.forEach(function(s){s.match(/^\d+$/)||r.push(l(t,e,n,i,s,!0))}),r}function l(t,e,n,i,s,r){var o,a,u;if(u=Object.getOwnPropertyDescriptor(e,s)||{value:e[s]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),z(i,s)||(o="["+s+"]"),a||(t.seen.indexOf(u.value)<0?(a=y(n)?c(t,u.value,null):c(t,u.value,n-1),a.indexOf("\n")>-1&&(a=r?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(o)){if(r&&s.match(/^\d+$/))return a;o=JSON.stringify(""+s),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function f(t,e,n){var i=0,s=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return s>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return null===t}function g(t){return null==t}function m(t){return"number"==typeof t}function w(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function x(t){return void 0===t}function _(t){return I(t)&&"[object RegExp]"===L(t)}function I(t){return"object"==typeof t&&null!==t}function E(t){return I(t)&&"[object Date]"===L(t)}function S(t){return I(t)&&("[object Error]"===L(t)||t instanceof Error)}function O(t){return"function"==typeof t}function k(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function L(t){return Object.prototype.toString.call(t)}function D(t){return 10>t?"0"+t.toString(10):t.toString(10)}function C(){var t=new Date,e=[D(t.getHours()),D(t.getMinutes()),D(t.getSeconds())].join(":");return[t.getDate(),j[t.getMonth()],e].join(" ")}function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var B=/%[sdj%]/g;n.format=function(t){if(!w(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,r=i.length,o=String(t).replace(B,function(t){if("%%"===t)return"%";if(n>=r)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),a=i[n];r>n;a=i[++n])o+=y(a)||!I(a)?" "+a:" "+s(a);return o},n.deprecate=function(t,s){function r(){if(!o){if(e.throwDeprecation)throw new Error(s);e.traceDeprecation?console.trace(s):console.error(s),o=!0}return t.apply(this,arguments)}if(x(i.process))return function(){return n.deprecate(t,s).apply(this,arguments)};if(e.noDeprecation===!0)return t;var o=!1;return r};var P,R={};n.debuglog=function(t){if(x(P)&&(P=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(P)){var i=e.pid;R[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else R[t]=function(){};return R[t]},n.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=v,n.isNull=y,n.isNullOrUndefined=g,n.isNumber=m,n.isString=w,n.isSymbol=b,n.isUndefined=x,n.isRegExp=_,n.isObject=I,n.isDate=E,n.isError=S,n.isFunction=O,n.isPrimitive=k,n.isBuffer=t("./support/isBuffer");var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",C(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!I(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":4,_process:3,inherits:2}],6:[function(t,e,n){var i=t("../../settings"),s=function(t){this.entity=t,this.flapIndex=0,this.freakingOut=!1,this.images=[document.getElementById("bird2"),document.getElementById("bird1"),document.getElementById("bird2"),document.getElementById("bird3")],this.radians=0,this.interval=window.setInterval(this.flap.bind(this),120)};s.prototype.flap=function(){this.flapIndex+=1,this.flapIndex>=this.images.length&&(this.flapIndex=0)},s.prototype.freakOut=function(){if(!this.freakingOut){var t=this;this.freakingOut=!0,setTimeout(function(){t.freakingOut=!1},240)}},s.prototype.draw=function(t){var e=this.entity.components.physics.position;t.save(),t.translate(e.x,e.y),t.scale(-1,1),t.rotate(Math.PI),t.save(),t.translate(i.birdRadius/2,i.birdRadius/2),t.rotate(this.radians);var n=this.entity.components.physics.velocity.y;n=Math.max(i.minVerticalVelocity,n),n=Math.min(i.maxVerticalVelocity,n),n=-n;var s=i.noseDive;t.beginPath(),t.drawImage(this.images[this.flapIndex],-i.birdRadius/2,-i.birdRadius/2,i.birdRadius,i.birdRadius),t.restore(),t.closePath(),t.restore(),this.freakingOut?this.radians+=Math.degreesToRadians(-45):(this.radians=Math.degreesToRadians(n*s),this.radians-=Math.degreesToRadians(30))},n.BirdGraphicsComponent=s},{"../../settings":13}],7:[function(t,e,n){var i=t("events"),s=t("util"),r=t("../../settings"),o=function(t){this.entity=t,this.image=document.getElementById("pipe"),this.emitted=!1};s.inherits(o,i),o.prototype.draw=function(t){var e=this.entity.components.physics.position,n=this.entity.flip;t.save(),t.translate(e.x,e.y),e.x<-r.pipeWidth&&!this.emitted&&(this.emit("passed",this),this.emitted=!0),n&&t.scale(1,-1);var i=this.image;t.drawImage(i,0,0,r.pipeWidth,1),t.restore()},n.PipeGraphicsComponent=o},{"../../settings":13,events:1,util:5}],8:[function(t,e,n){var i=function(t){this.entity=t,this.position={x:0,y:0},this.velocity={x:0,y:0},this.acceleration={x:0,y:0}};i.prototype.update=function(t,e){e&&(this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t),this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t},n.PhysicsComponent=i},{}],9:[function(t,e,n){var i=t("../components/graphics/bird"),s=t("../components/physics/physics"),r=t("../settings"),o=function(){var t=new s.PhysicsComponent(this);t.position.y=.5,t.acceleration.y=-r.gravity||-.75;var e=new i.BirdGraphicsComponent(this);this.scores=[],this.components={physics:t,graphics:e}};o.prototype.freakOutOver=function(t){for(var e=this.scores,n=0;n<e.length;n++)if(e[n]==t)return!1;return this.components.graphics.freakOut(),e.push(t),!0},n.Bird=o},{"../components/graphics/bird":6,"../components/physics/physics":8,"../settings":13}],10:[function(t,e,n){var i=t("../components/graphics/pipe"),s=t("../components/physics/physics"),r=t("events"),o=t("util"),a=function(t,e,n){var r=this;this.id="undefined"==typeof n?"":n,this.flip="undefined"==typeof e?!1:e;var o=new s.PhysicsComponent(this);o.position.x=t.x,o.position.y=t.y,o.velocity.x=-.4;var a=new i.PipeGraphicsComponent(this);a.on("passed",function(t){r.emit("passed",t)}),this.components={physics:o,graphics:a}};o.inherits(a,r),n.Pipe=a},{"../components/graphics/pipe":7,"../components/physics/physics":8,events:1,util:5}],11:[function(t,e,n){Math.randomRange=function(t,e){return t+Math.random()*(e-t)},Math.degreesToRadians=function(t){return t*Math.PI/180},Math.radiansToDegrees=function(t){return 180*t/Math.PI};var i=t("./systems/graphics"),s=t("./systems/physics"),r=t("./systems/input"),o=t("./systems/pipe_system"),a=t("./entities/bird"),c=(t("./settings"),function(){var t=this;this.gameOver=!1,this.score=0,this.paused=!1,this.autopilotEnabled=!0;var e=new a.Bird;setTimeout(function(){e.freakOutOver(0)},200),this.entities=[e],this.graphics=new i.GraphicsSystem(this),this.physics=new s.PhysicsSystem(this.entities),this.input=new r.InputSystem(this.entities),this.pipes=new o.PipeSystem(this.entities),this.pipes.on("passed",function(e){t.score=e,t.gameOver||console.log(e)}),this.graphics.on("collision",function(e,n,i){t.gameOver||console.log("Game over! You cleared "+t.score+" pipes!"),t.gameOver=!0;var s=function(){return(t.gameOver=!0)?"Score: "+t.score:void 0},r=document.getElementById("score");r.innerHTML=s();t.gameOver&&(t.graphics.pause(),t.physics.pause(),t.pipes.pause(),$("#game-over").delay(500).fadeIn(2e3))});var n=document.getElementById("#replay");n.onclick=function(){location.reload(!0)},this.input.on("visibilitychange",function(e){console.log("visibilitychange",e),e?(t.graphics.paused=!1,t.physics.run(),t.pipes.run()):(t.graphics.pause(),t.physics.pause(),t.pipes.pause())}),this.pipes.on("pipeadded",function(){var e=t.entities;e=e.filter(function(e){return e.components.physics.position.x>-(t.graphics.canvas.width/t.graphics.canvas.height)?!0:!1}),t.entities=t.graphics.entities=t.physics.entities=t.input.entities=t.pipes.entities=e}),this.input.on("Paused",this.handlePaused.bind(this));var c=function(){this.graphics.pause(),this.physics.pause(),this.pipes.pause()};(this.autopilotEnabled=!0)&&c(),this.input.on("Started",function(){this.autopilotEnabled=!1,console.log("autopilot is off!")})});c.prototype.handlePaused=function(){this.paused=!this.paused,this.paused?(this.graphics.pause(),this.physics.pause(),this.pipes.pause()):(this.graphics.run(),this.physics.run(),this.pipes.run())},c.prototype.run=function(){this.graphics.run(),this.physics.run(),this.input.run(),this.pipes.run()},n.FlappyBird=c},{"./entities/bird":9,"./settings":13,"./systems/graphics":14,"./systems/input":15,"./systems/physics":16,"./systems/pipe_system":17}],12:[function(t,e,n){var i=t("./flappy_bird");document.addEventListener("DOMContentLoaded",function(){var t=new i.FlappyBird;t.run()})},{"./flappy_bird":11}],13:[function(t,e,n){n.birdRadius=.1,n.pipeWidth=.2,n.collisionAllowance=1,n.gravity=2.25,n.lift=.75,n.noseDive=120,n.minVerticalVelocity=-1,n.maxVerticalVelocity=0,n.freakOutEvery=2,n.displayFPS=!1,n.collisionDetectionPerSecond=12},{}],14:[function(t,e,n){var i=t("events"),s=t("util"),r=t("../settings"),o=function(t){function e(){i.width=window.innerWidth,i.height=window.innerHeight,n.calculations.birdSize=.1*i.height,n.calculations.halfWidth=i.width/2,n.calculations.birdSizeBuffer=1.2*n.calculations.birdSize,s.width=n.calculations.birdSizeBuffer,s.height=n.calculations.birdSizeBuffer}this.flappyBird=t;var n=this;this.entities=t.entities,this.canvas=document.getElementById("main-canvas"),this.offcanvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.interval=null,this.showBoundingBox=!1,this.showCollisionDetection=!1,this.paused=!1,this.lastStamp=null,this.numerals=document.getElementById("numerals");var i=this.canvas,s=this.offcanvas;n.calculations={},e(),window.onresize=function(){e()}};s.inherits(o,i),o.prototype.run=function(){window.requestAnimationFrame(this.tick.bind(this)),this.interval=window.setInterval(this.tock.bind(this),Math.round(1e3/r.collisionDetectionPerSecond))},o.prototype.pause=function(){clearInterval(this.interval)},o.prototype.tock=function(){var t=this,e=this.canvas,n=this.offcanvas,i=n.getContext("2d");this.clearContext(n);var s=this.entities[0],o={x:t.calculations.halfWidth,y:(1-s.components.physics.position.y)*e.height,width:t.calculations.birdSizeBuffer,height:t.calculations.birdSizeBuffer},a=function(e,n){if(!1 in e.components||!1 in e.components)return!1;n.width=t.canvas.width,n.height=t.canvas.height;var i=n.getContext("2d");e.components.physics.position;i.save(),i.translate(t.calculations.halfWidth,t.canvas.height),i.scale(t.canvas.height,-t.canvas.height),e.components.graphics.draw(i);var s=i.getImageData(o.x,o.y,o.width,o.height);return s=t.colorizeImageData(s,[0,255,0,255]),i.restore(),t.clearContext(n),s}(s,document.createElement("canvas")),c=function(e,n){n.width=t.canvas.width,n.height=t.canvas.height;var i=n.getContext("2d");i.save(),i.translate(t.calculations.halfWidth,t.canvas.height),i.scale(t.canvas.height,-t.canvas.height);for(var s=0;s<e.length;s++){var r=e[s];"graphics"in r.components&&r.components.graphics.draw(i)}var a=i.getImageData(o.x,o.y,o.width,o.height);return a=t.colorizeImageData(a,[255,0,0,255]),i.restore(),t.clearContext(n),a}(this.entities.slice(1),document.createElement("canvas"));i.restore(),i.clearRect(0,0,n.width,n.height),i.globalCompositeOperation="multiply",i.drawImage(t.dataURLtoImg(t.imgDataToDataURL(c)),0,0),i.drawImage(t.dataURLtoImg(t.imgDataToDataURL(a)),0,0);var u=function(){for(var t=i.getImageData(0,0,n.width,n.height),e=t.data,s=0,o=0;o<=e.length-4;o+=4){var a=255==e[o]&&!e[o+1]&&!e[o+2],c=!e[o]&&255==e[o+1]&&!e[o+2],u=0==e[o]&&0==e[o+1]&&0==e[o+2]&&0==e[o+3];if(a||c||u||s++,s>r.collisionAllowance)return!0}return!1}();u&&t.emit("collision")},o.prototype.tick=function(t){var e=this,n=this.canvas,i=this.offcanvas;i.getContext("2d");this.clearContext(n);var s=this.entities[0];({x:e.calculations.halfWidth,y:(1-s.components.physics.position.y)*n.height,width:e.calculations.birdSizeBuffer,height:e.calculations.birdSizeBuffer});this.context.save(),this.context.translate(e.calculations.halfWidth,this.canvas.height),this.context.scale(this.canvas.height,-this.canvas.height);for(var o=0;o<this.entities.length;o++){var a=this.entities[o];"graphics"in a.components&&a.components.graphics.draw(this.context)}this.context.restore(),function(t){var e=t.flappyBird.score,n=e.toString().split("");e&&e%r.freakOutEvery==0&&s.freakOutOver(e),t.context.save(),t.context.translate(t.calculations.halfWidth-30*t.flappyBird.score.toString().length,0);for(var i=0;i<n.length;i++){var o=function(t){var e=document.createElement("canvas"),n=e.getContext("2d"),t="undefined"==typeof t?0:parseInt(t);e.width=60,e.height=80,n.translate(-60*t,0),n.drawImage(document.getElementById("numerals"),0,0,600,80);var i=n.getImageData(0,0,e.width,e.height);return i}(n[i]);t.context.drawImage(t.dataURLtoImg(t.imgDataToDataURL(o)),30*i,0)}t.context.restore()}(this),r.displayFPS&&!function(n,i){var s=1e3/(t-i);n.font="12px Verdana",n.fillStyle="red",n.fillText(s.toString(),16,e.canvas.height-16)}(this.context,this.lastStamp),this.lastStamp=t,this.paused||window.requestAnimationFrame(this.tick.bind(this))},o.prototype.colorizeImageData=function(t,e){for(var n=t.data,i=0;i<=n.length-4;i+=4)(n[i]||n[i+1]||n[i+2]||n[i+3])&&(n[i]=e[0],n[i+1]=e[1],n[i+2]=e[2],n[i+3]=e[3]);return t},o.prototype.imgDataToDataURL=function(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e.toDataURL()},o.prototype.dataURLtoImg=function(t){var e=new Image;return e.src=t,e},o.prototype.clearContext=function(t,e,n,i,s){e="undefined"==typeof e?0:e,n="undefined"==typeof n?0:n,i="undefined"==typeof i?t.width:i,s="undefined"==typeof s?t.height:s,t.getContext("2d").clearRect(e,n,i,s)},n.GraphicsSystem=o},{"../settings":13,events:1,util:5}],15:[function(t,e,n){var i=t("events"),s=t("util"),r=t("../settings"),o=function(t){this.entities=t;var e=this;this.canvas=document.getElementById("main-canvas");var n;"undefined"!=typeof document.hidden?n="visibilitychange":"undefined"!=typeof document.mozHidden?n="mozvisibilitychange":"undefined"!=typeof document.msHidden?n="msvisibilitychange":"undefined"!=typeof document.webkitHidden&&(n="webkitvisibilitychange"),this.waiting=setInterval(function(){console.log("fake flap!"),e.onClick()},1e3),document.body.addEventListener("click",function(){clearInterval(e.waiting)}),document.addEventListener(n,this.handleVisibilityChange.bind(this),!1)};s.inherits(o,i),o.prototype.run=function(){document.body.addEventListener("click",this.onClick.bind(this)),document.body.addEventListener("keydown",this.onkeydown.bind(this))},o.prototype.onClick=function(){var t=this.entities[0];t.components.physics.velocity.y=r.lift},o.prototype.onkeydown=function(t){if(!e){var e=!0;this.emit("Started"),console.log(e)}if(clearInterval(this.waiting),32==t.keyCode){var n=this.entities[0];n.components.physics.velocity.y=r.lift}else 80==t.keyCode&&this.emit("Paused")},o.prototype.handleVisibilityChange=function(){var t;"undefined"!=typeof document.hidden?t="hidden":"undefined"!=typeof document.mozHidden?t="mozHidden":"undefined"!=typeof document.msHidden?t="msHidden":"undefined"!=typeof document.webkitHidden&&(t="webkitHidden"),document[t]?this.emit("visibilitychange",!1):this.emit("visibilitychange",!0)},n.InputSystem=o},{"../settings":13,events:1,util:5}],16:[function(t,e,n){var i=function(t){this.entities=t,this.interval=null};i.prototype.run=function(){this.interval=window.setInterval(this.tick.bind(this),1e3/60)},i.prototype.pause=function(){clearInterval(this.interval)},i.prototype.tick=function(){for(var t=0;t<this.entities.length;t++){var e=this.entities[t];!1 in e.components||e.components.physics.update(1/60,1>t)}},n.PhysicsSystem=i},{}],17:[function(t,e,n){var i=t("../entities/pipe"),s=t("events"),r=t("util"),o=function(t){this.entities=t,this.canvas=document.getElementById("main-canvas"),this.interval=null,this.pipesPassed=0};r.inherits(o,s),o.prototype.run=function(){this.tick(),this.interval=window.setInterval(this.tick.bind(this),2e3)},o.prototype.pause=function(){null!=this.interval&&(window.clearInterval(this.interval),this.interval=null)},o.prototype.tick=function(){function t(t,n,i,s){var t=new t.Pipe(n,i,s);return t.on("passed",function(t){t.entity.flip&&(e.pipesPassed++,e.emit("passed",e.pipesPassed))}),t}var e=this,n={x:this.canvas.width/this.canvas.height,y:Math.randomRange(.25,.65)},s=(this.entities.length-1)/2;this.entities.push(t(i,n,!0,s)),n.y+=.25,this.entities.push(t(i,n,!1,s)),this.emit("pipeadded")},n.PipeSystem=o},{"../entities/pipe":10,events:1,util:5}]},{},[12]);